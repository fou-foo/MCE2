tamanio_ensemble<-5000
L<-array(0,dim = c(length(f.densidad(N,M,beta)),0))
for (i in 1:tamanio_ensemble) {
L<-cbind(L,f.densidad(N,M,beta))
print(i)
}
res<-hist(L,breaks = 100,col = "red",border = "black")
res<-density(L/100,n = 100)
valor<-density(rmp(n = tamanio_ensemble,ndf = 200,pdim = 100),n=100 )
ks.test(res$y, valor$y/2 )
valo
valor
valor$y
ks.test(res$y, valor$y/2 )
plot(res$x,res$y,main="Test K-S")
lines(valor$x*2,valor$y/2,col="blue")
ks.test(L, rmp(n = tamanio_ensemble,ndf = 200,pdim = 100))
ks.test(L/100, rmp(n = tamanio_ensemble,ndf = 200,pdim = 100)/2)
ks.test(L/100, rmp(n = tamanio_ensemble,ndf = 200,pdim = 100)/2, exact = TRUE)
?ks.test
ks.test(L/100, rmp(n = tamanio_ensemble,ndf = 200,pdim = 100)/2, exact = TRUE)
ks.test(L/100, rmp(n = tamanio_ensemble,ndf = 200,pdim = 100)/2, exact = FALSE)
13+15
devtools::install_github('diegovalle/mxmaps')
install.packages("sf")
load("/home/fou/Desktop/Ecobici/DataSubset/.RData")
1270*.2
load('serie_diaria.Rdata')
shiny::runApp('Desktop/Ecobici/Shiny')
runApp('Desktop/Ecobici/Shiny')
load('serie_diaria.Rdata')
setwd("/home/fou/Desktop/Ecobici/Data/")
load('serie_diaria.Rdata')
serie_diaria
runApp('~/Desktop/Ecobici/Shiny')
runApp('~/Desktop/Ecobici/Shiny/dwd')
runApp('~/Desktop/Ecobici/Shiny')
runApp('~/Desktop/Ecobici/Shiny')
runApp('~/Desktop/Ecobici/Shiny')
runApp('~/Desktop/Ecobici/Shiny')
?boxcox
?box
?plotlyOutput
runApp('~/Desktop/Ecobici/Shiny')
?box
runApp('~/Desktop/Ecobici/Shiny')
?dashboardHeader
runApp('~/Desktop/Ecobici/Shiny')
runApp('~/Desktop/Ecobici/Shiny')
runApp('~/Desktop/Ecobici/Shiny')
runApp('~/Desktop/Ecobici/Shiny')
runApp('~/Desktop/Ecobici/Shiny')
runApp('~/Desktop/Ecobici/Shiny')
runApp('~/Desktop/Ecobici/Shiny')
runApp('~/Desktop/Ecobici/Shiny')
setwd("/home/fou/Desktop/Ecobici/DataSubset/")
library(readr)
library(lubridate)
library(hms)
load( file='tablaFiltro.Rdata')
library(ggplot2)
library(plotly)
names(tabla2)
tabla2%>% select(Genero_Usuario, Edad_Usuario ) %>% group_by(Genero_Usuario, Edad_Usuario) %>%
summarise(Porcentaje =n()) -> x
x %>% group_by(Genero_Usuario)%>% summarise(Porcentaje=sum(Porcentaje)) -> x
x$Porcentaje <- x$Porcentaje/sum(x$Porcentaje)
names(x) <- c('Genero', 'Porcentaje')
class(x) <- 'data.frame'
p <- ggplot(x, aes(x=Genero, y=Porcentaje, fill=Genero)) + geom_bar(stat = 'identity')  +
scale_fill_manual(values=c('#604B89', 'orange')) + theme_minimal() +xlab('') +ylab('') +
ggtitle('Distribución del generó')
p <- ggplotly(p)
tabla2 %>% group_by(Fecha_Retiro) %>% summarise(viajes=n()) -> viajes.salida
p
library(dplyr)
setwd("/home/fou/Desktop/Ecobici/DataSubset/")
library(readr)
library(lubridate)
library(dplyr)
library(hms)
load( file='tablaFiltro.Rdata')
library(ggplot2)
library(plotly)
names(tabla2)
tabla2%>% select(Genero_Usuario, Edad_Usuario ) %>% group_by(Genero_Usuario, Edad_Usuario) %>%
summarise(Porcentaje =n()) -> x
x %>% group_by(Genero_Usuario)%>% summarise(Porcentaje=sum(Porcentaje)) -> x
x$Porcentaje <- x$Porcentaje/sum(x$Porcentaje)
names(x) <- c('Genero', 'Porcentaje')
class(x) <- 'data.frame'
p <- ggplot(x, aes(x=Genero, y=Porcentaje, fill=Genero)) + geom_bar(stat = 'identity')  +
scale_fill_manual(values=c('#604B89', 'orange')) + theme_minimal() +xlab('') +ylab('') +
ggtitle('Distribución del generó')
p
p <- ggplotly(p)
tabla2 %>% group_by(Fecha_Retiro) %>% summarise(viajes=n()) -> viajes.salida
p
#############################################
names(viajes.salida)
sapply(viajes.salida, class)
p <- ggplot(viajes.salida, aes(x=dmy(Fecha_Retiro), y=viajes)) + geom_line(colour='#604B89') +
xlim(c(ymd('2017-01-01'), ymd('2018-10-31'))) + theme_minimal() + xlab('Fecha') + ylab('Viajes por día') +
ggtitle('Viajes en ECOBICI')
p
ggplotly(p)
save(p, file='DelimitacionTiempo.Rdata')
runApp('~/Desktop/Ecobici/Shiny')
runApp('~/Desktop/Ecobici/Shiny')
runApp('~/Desktop/Ecobici/Shiny')
load('DelimitacionTiempo.Rdata')
load('DelimitacionTiempo.Rdata')
setwd("~/Desktop/Ecobici/DataSubset")
load('DelimitacionTiempo.Rdata')
setwd("~/Desktop/Ecobici/Shiny")
load('DelimitacionTiempo.Rdata')
DelimitacionTiempo <- p
save(DelimitacionTiempo, 'DelimitacionTiempo.Rdata')
save(DelimitacionTiempo, file ='DelimitacionTiempo.Rdata')
load('DelimitacionTiempo.Rdata')
load('DelimitacionTiempo.Rdata')
runApp()
setwd("/home/fou/Desktop/Ecobici/DataSubset/")
library(readr)
library(lubridate)
library(dplyr)
library(hms)
load( file='tablaFiltro.Rdata')
library(ggplot2)
library(plotly)
names(tabla2)
tabla2%>% select(Genero_Usuario, Edad_Usuario ) %>% group_by(Genero_Usuario, Edad_Usuario) %>%
summarise(Porcentaje =n()) -> x
x %>% group_by(Genero_Usuario)%>% summarise(Porcentaje=sum(Porcentaje)) -> x
x$Porcentaje <- x$Porcentaje/sum(x$Porcentaje)
names(x) <- c('Genero', 'Porcentaje')
class(x) <- 'data.frame'
p <- ggplot(x, aes(x=Genero, y=Porcentaje, fill=Genero)) + geom_bar(stat = 'identity')  +
scale_fill_manual(values=c('#604B89', 'orange')) + theme_minimal() +xlab('') +ylab('') +
ggtitle('Distribución del generó')
p <- ggplotly(p)
tabla2 %>% group_by(Fecha_Retiro) %>% summarise(viajes=n()) -> viajes.salida
p
genero <- p
save(genero, file='genero.Rdata')
#############################################
names(viajes.salida)
sapply(viajes.salida, class)
p <- ggplot(viajes.salida, aes(x=dmy(Fecha_Retiro), y=viajes)) + geom_line(colour='#604B89') +
xlim(c(ymd('2017-01-01'), ymd('2018-10-31'))) + theme_minimal() + xlab('Fecha') + ylab('Viajes por día') +
ggtitle('Viajes en ECOBICI')
p
ggplotly(p)
hora <- p
###############################
# En que horarios hay mayor afluencia ?
##############################
tabla2 %>% select(Hora_Retiro) %>%  group_by(Hora_Retiro) %>% summarise(viajes=n()) -> horarios
horarios$Hora_Retiro <- as.hms(horarios$Hora_Retiro)
p <- ggplot(horarios, aes(x=Hora_Retiro , y=viajes)) + geom_line(colour='#604B89') +
theme_minimal() + xlab('Horario') + ylab('Viajes') +
ggtitle('Viajes en ECOBICI, por segundo')
p <- ggplotly(p)
p
hora <- p
save(hora, file='genero.Rdata')
load( file='tablaFiltro.Rdata')
library(ggplot2)
library(plotly)
names(tabla2)
tabla2%>% select(Genero_Usuario, Edad_Usuario ) %>% group_by(Genero_Usuario, Edad_Usuario) %>%
summarise(Porcentaje =n()) -> x
x %>% group_by(Genero_Usuario)%>% summarise(Porcentaje=sum(Porcentaje)) -> x
x$Porcentaje <- x$Porcentaje/sum(x$Porcentaje)
names(x) <- c('Genero', 'Porcentaje')
class(x) <- 'data.frame'
p <- ggplot(x, aes(x=Genero, y=Porcentaje, fill=Genero)) + geom_bar(stat = 'identity')  +
scale_fill_manual(values=c('#604B89', 'orange')) + theme_minimal() +xlab('') +ylab('') +
ggtitle('Distribución del generó')
p <- ggplotly(p)
tabla2 %>% group_by(Fecha_Retiro) %>% summarise(viajes=n()) -> viajes.salida
p
genero <- p
save(genero, file='genero.Rdata')
#############################################
names(viajes.salida)
sapply(viajes.salida, class)
p <- ggplot(viajes.salida, aes(x=dmy(Fecha_Retiro), y=viajes)) + geom_line(colour='#604B89') +
xlim(c(ymd('2017-01-01'), ymd('2018-10-31'))) + theme_minimal() + xlab('Fecha') + ylab('Viajes por día') +
ggtitle('Viajes en ECOBICI')
p
ggplotly(p)
hora <- p
###############################
# En que horarios hay mayor afluencia ?
##############################
tabla2 %>% select(Hora_Retiro) %>%  group_by(Hora_Retiro) %>% summarise(viajes=n()) -> horarios
horarios$Hora_Retiro <- as.hms(horarios$Hora_Retiro)
p <- ggplot(horarios, aes(x=Hora_Retiro , y=viajes)) + geom_line(colour='#604B89') +
theme_minimal() + xlab('Horario') + ylab('Viajes') +
ggtitle('Viajes en ECOBICI, por segundo')
p <- ggplotly(p)
p
hora <- p
save(hora, file='hora.Rdata')
runApp('~/Desktop/Ecobici/Shiny')
runApp('~/Desktop/Ecobici/Shiny')
load('genero.Rdata')
load('hora.Rdata')
setwd("~/Desktop/Ecobici/Shiny")
load('genero.Rdata')
load('hora.Rdata')
runApp()
shiny::runApp()
shiny::runApp('Desktop/MCE2/4/SPI2019/app')
runApp('Desktop/MCE2/4/SPI2019/app')
runApp('Desktop/MCE2/4/SPI2019/app')
runApp('Desktop/MCE2/4/SPI2019/app')
runApp('Desktop/MCE2/4/SPI2019/app')
runApp('Desktop/MCE2/4/SPI2019/app')
runApp('Desktop/MCE2/4/SPI2019/app')
runApp('Desktop/MCE2/4/SPI2019/app')
# En analisis de sensibilidad mostro que las 5 variables numericas mas importantes son
importantes.numericas <- c('Enfriamiento.i_TORElev4', 'Enfriamiento.i_HSRElev4',
'Enfriamiento.i_TORElev5', 'Enfriamiento.i_HSRElev5',
'dRuido2')
importantes.categoricas <- c('Garantias.dCapExcitacion', 'Garantias.dCapEficReg',
'Garantias.dCapPerd', 'Enfriamiento.i_ElevTempP3',
'iDestino')
####################################################################
setwd('/home/fou/Desktop/MCE2/4/SPI2019/app')
dir()
administrativas <- c(1,2,3,8,9)
categoricas <- c(4, 5, 6, 11, 12, 18, 19, 20, 21, 28, 29, 30, 31, 35, 55,
57, 63, 64, 65, 66, 67, 69, 70, 71, 72, 73, 74, 75, 76, 77,
88, 89, 90, 100, 101, 111, 112, 114, 117, 130, 132, 133, 134,
135, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 170)
embarque <- 29:34
numericas <- c(13, 15, 17, 22, 23, 24, 25, 26, 27, 32, 33, 34, 36, 37, 38, 45,
46, 47, 48, 49, 50, 58, 59, 60, 68, 78, 79, 80, 81, 82, 83, 84, 85,
86, 87, 91, 93, 94, 97, 98, 102, 106, 107, 126, 127, 128, 129)
# definicion de funciones para rellenar el transformador base de la simulacion
calcula.moda <- function(x)
{
# x (character): columna de tipo caracter
# salida: mode de la columna
frecuencias <- table(x)
maxi <- which.max(frecuencias)
moda <- frecuencias[maxi]
return(names(moda))
}
calcula.mediana <- function(x)
{
# x (numeric): columna de tipo numerica
# salida: mediana de la columna
mediana <- median(x)
return( mediana)
}
###############################################
# correcion de tipos de Datos y construccion del transformador base para la simulacion en la app ###########
datos <- read.csv("dataframeVerdesPresentes.csv", stringsAsFactors = FALSE) #
s <- datos
sapply(datos, class)
# cast de numericas a factores 'character' para que las salidas de 'predict' sean caracteres y no niveles
datos[, categoricas] <- lapply(datos[, categoricas], function(x) as.character(x))
datos[, embarque] <- lapply(datos[, embarque], function(x) as.character(x))
# construccion de transformacion base para la app
entrada <- datos[1, ]
entrada[1, categoricas] <- mapply(datos[, categoricas], FUN=calcula.moda)
entrada[1, embarque] <- mapply(datos[, embarque], FUN=calcula.moda)
entrada[1, numericas] <- mapply(datos[, numericas], FUN=calcula.mediana)
datos <- datos[, -administrativas]    # eliminamos las variables 'administrativas' por no ser importantes para la prediccion
entrada <- entrada[, -administrativas]
entrada <- entrada[, c(importantes.categoricas, importantes.numericas)]
sample <- datos[, c(importantes.categoricas, importantes.numericas)]
library(randomForestSRC)
importantes.categoricas[1]
?rfsrcFast
sample <- datos[, c(importantes.categoricas, importantes.numericas)]
library(randomForestSRC)
importantes.categoricas[1]
inicio <- Sys.time()
m <- rfsrcFast(Garantias.dCapExcitacion~., data=sample,
ntree = 1,
nsplit = 1)
fin <- Sys.time()
# En analisis de sensibilidad mostro que las 5 variables numericas mas importantes son
importantes.numericas <- c('Enfriamiento.i_TORElev4', 'Enfriamiento.i_HSRElev4',
'Enfriamiento.i_TORElev5', 'Enfriamiento.i_HSRElev5',
'dRuido2')
importantes.categoricas <- c('Garantias.dCapExcitacion', 'Garantias.dCapEficReg',
'Garantias.dCapPerd', 'Enfriamiento.i_ElevTempP3',
'iDestino')
####################################################################
setwd('/home/fou/Desktop/MCE2/4/SPI2019/app')
dir()
administrativas <- c(1,2,3,8,9)
categoricas <- c(4, 5, 6, 11, 12, 18, 19, 20, 21, 28, 29, 30, 31, 35, 55,
57, 63, 64, 65, 66, 67, 69, 70, 71, 72, 73, 74, 75, 76, 77,
88, 89, 90, 100, 101, 111, 112, 114, 117, 130, 132, 133, 134,
135, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 170)
embarque <- 29:34
numericas <- c(13, 15, 17, 22, 23, 24, 25, 26, 27, 32, 33, 34, 36, 37, 38, 45,
46, 47, 48, 49, 50, 58, 59, 60, 68, 78, 79, 80, 81, 82, 83, 84, 85,
86, 87, 91, 93, 94, 97, 98, 102, 106, 107, 126, 127, 128, 129)
# definicion de funciones para rellenar el transformador base de la simulacion
calcula.moda <- function(x)
{
# x (character): columna de tipo caracter
# salida: mode de la columna
frecuencias <- table(x)
maxi <- which.max(frecuencias)
moda <- frecuencias[maxi]
return(names(moda))
}
# definicion de funciones para rellenar el transformador base de la simulacion
calcula.moda <- function(x)
{
# x (character): columna de tipo caracter
# salida: mode de la columna
frecuencias <- table(as.character(x))
maxi <- which.max(frecuencias)
moda <- frecuencias[maxi]
return(names(moda))
}
calcula.mediana <- function(x)
{
# x (numeric): columna de tipo numerica
# salida: mediana de la columna
mediana <- median(x)
return( mediana)
}
###############################################
# correcion de tipos de Datos y construccion del transformador base para la simulacion en la app ###########
datos <- read.csv("dataframeVerdesPresentes.csv", stringsAsFactors = FALSE) #
s <- datos
sapply(datos, class)
# cast de numericas a factores 'character' para que las salidas de 'predict' sean caracteres y no niveles
datos[, categoricas] <- lapply(datos[, categoricas], function(x) factor(x))
datos[, embarque] <- lapply(datos[, embarque], function(x) factor(x))
# construccion de transformacion base para la app
entrada <- datos[1, ]
entrada[1, categoricas] <- mapply(datos[, categoricas], FUN=calcula.moda)
entrada[1, embarque] <- mapply(datos[, embarque], FUN=calcula.moda)
entrada[1, numericas] <- mapply(datos[, numericas], FUN=calcula.mediana)
entrada[1, numericas] <- mapply(datos[, numericas], FUN=calcula.mediana)
datos[, numericas]
datos$dZsy
###############################################
# correcion de tipos de Datos y construccion del transformador base para la simulacion en la app ###########
datos <- read.csv("dataframeVerdesPresentes.csv", stringsAsFactors = FALSE) #
datos$dZsy
as.numeric(datos$dZsy)
match('dZsy', names(datos))
c(administrativas, 26)
# En analisis de sensibilidad mostro que las 5 variables numericas mas importantes son
importantes.numericas <- c('Enfriamiento.i_TORElev4', 'Enfriamiento.i_HSRElev4',
'Enfriamiento.i_TORElev5', 'Enfriamiento.i_HSRElev5',
'dRuido2')
importantes.categoricas <- c('Garantias.dCapExcitacion', 'Garantias.dCapEficReg',
'Garantias.dCapPerd', 'Enfriamiento.i_ElevTempP3',
'iDestino')
####################################################################
setwd('/home/fou/Desktop/MCE2/4/SPI2019/app')
dir()
administrativas <- c(1,2,3,8,9)
categoricas <- c(4, 5, 6, 11, 12, 18, 19, 20, 21, 28, 29, 30, 31, 35, 55,
57, 63, 64, 65, 66, 67, 69, 70, 71, 72, 73, 74, 75, 76, 77,
88, 89, 90, 100, 101, 111, 112, 114, 117, 130, 132, 133, 134,
135, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 170)
embarque <- 29:34
numericas <- c(13, 15, 17, 22, 23, 24, 25, 26, 27, 32, 33, 34, 36, 37, 38, 45,
46, 47, 48, 49, 50, 58, 59, 60, 68, 78, 79, 80, 81, 82, 83, 84, 85,
86, 87, 91, 93, 94, 97, 98, 102, 106, 107, 126, 127, 128, 129)
# definicion de funciones para rellenar el transformador base de la simulacion
calcula.moda <- function(x)
{
# x (character): columna de tipo caracter
# salida: mode de la columna
frecuencias <- table(as.character(x))
maxi <- which.max(frecuencias)
moda <- frecuencias[maxi]
return(names(moda))
}
calcula.mediana <- function(x)
{
# x (numeric): columna de tipo numerica
# salida: mediana de la columna
mediana <- median(x)
return( mediana)
}
###############################################
# correcion de tipos de Datos y construccion del transformador base para la simulacion en la app ###########
datos <- read.csv("dataframeVerdesPresentes.csv", stringsAsFactors = FALSE) #
s <- datos
sapply(datos, class)
# cast de numericas a factores 'character' para que las salidas de 'predict' sean caracteres y no niveles
datos[, categoricas] <- lapply(datos[, categoricas], function(x) factor(x))
datos[, embarque] <- lapply(datos[, embarque], function(x) factor(x))
# construccion de transformacion base para la app
entrada <- datos[1, ]
entrada[1, categoricas] <- mapply(datos[, categoricas], FUN=calcula.moda)
entrada[1, embarque] <- mapply(datos[, embarque], FUN=calcula.moda)
entrada[1, numericas] <- mapply(datos[, numericas], FUN=calcula.mediana)
# En analisis de sensibilidad mostro que las 5 variables numericas mas importantes son
importantes.numericas <- c('Enfriamiento.i_TORElev4', 'Enfriamiento.i_HSRElev4',
'Enfriamiento.i_TORElev5', 'Enfriamiento.i_HSRElev5',
'dRuido2')
importantes.categoricas <- c('Garantias.dCapExcitacion', 'Garantias.dCapEficReg',
'Garantias.dCapPerd', 'Enfriamiento.i_ElevTempP3',
'iDestino')
####################################################################
setwd('/home/fou/Desktop/MCE2/4/SPI2019/app')
dir()
administrativas <- c(1,2,3,8,9)
categoricas <- c(4, 5, 6, 11, 12, 18, 19, 20, 21, 28, 29, 30, 31, 35, 55,
57, 63, 64, 65, 66, 67, 69, 70, 71, 72, 73, 74, 75, 76, 77,
88, 89, 90, 100, 101, 111, 112, 114, 117, 130, 132, 133, 134,
135, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 170)
embarque <- 29:34
numericas <- c(13, 15, 17, 22, 23, 24, 25,  27, 32, 33, 34, 36, 37, 38, 45,
46, 47, 48, 49, 50, 58, 59, 60, 68, 78, 79, 80, 81, 82, 83, 84, 85,
86, 87, 91, 93, 94, 97, 98, 102, 106, 107, 126, 127, 128, 129)
# definicion de funciones para rellenar el transformador base de la simulacion
calcula.moda <- function(x)
{
# x (character): columna de tipo caracter
# salida: mode de la columna
frecuencias <- table(as.character(x))
maxi <- which.max(frecuencias)
moda <- frecuencias[maxi]
return(names(moda))
}
calcula.mediana <- function(x)
{
# x (numeric): columna de tipo numerica
# salida: mediana de la columna
mediana <- median(x)
return( mediana)
}
###############################################
# correcion de tipos de Datos y construccion del transformador base para la simulacion en la app ###########
datos <- read.csv("dataframeVerdesPresentes.csv", stringsAsFactors = FALSE) #
s <- datos
sapply(datos, class)
# cast de numericas a factores 'character' para que las salidas de 'predict' sean caracteres y no niveles
datos[, categoricas] <- lapply(datos[, categoricas], function(x) factor(x))
datos[, embarque] <- lapply(datos[, embarque], function(x) factor(x))
# construccion de transformacion base para la app
entrada <- datos[1, ]
entrada[1, categoricas] <- mapply(datos[, categoricas], FUN=calcula.moda)
entrada[1, embarque] <- mapply(datos[, embarque], FUN=calcula.moda)
entrada[1, numericas] <- mapply(datos[, numericas], FUN=calcula.mediana)
sapply(datos[, numericas],class)
datos$iPesoEmbarqueMax
###############################################
# correcion de tipos de Datos y construccion del transformador base para la simulacion en la app ###########
datos <- read.csv("dataframeVerdesPresentes.csv", stringsAsFactors = FALSE) #
datos$iPesoEmbarqueMax
# En analisis de sensibilidad mostro que las 5 variables numericas mas importantes son
importantes.numericas <- c('Enfriamiento.i_TORElev4', 'Enfriamiento.i_HSRElev4',
'Enfriamiento.i_TORElev5', 'Enfriamiento.i_HSRElev5',
'dRuido2')
importantes.categoricas <- c('Garantias.dCapExcitacion', 'Garantias.dCapEficReg',
'Garantias.dCapPerd', 'Enfriamiento.i_ElevTempP3',
'iDestino')
####################################################################
setwd('/home/fou/Desktop/MCE2/4/SPI2019/app')
dir()
administrativas <- c(1,2,3,8,9)
categoricas <- c(4, 5, 6, 11, 12, 18, 19, 20, 21, 28, 29, 30, 31, 35, 55,
57, 63, 64, 65, 66, 67, 69, 70, 71, 72, 73, 74, 75, 76, 77,
88, 89, 90, 100, 101, 111, 112, 114, 117, 130, 132, 133, 134,
135, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 170)
embarque <- 29:34
numericas <- c(13, 15, 17, 22, 23, 24, 25,  27, 32, 33, 34, 36, 37, 38, 45,
46, 47, 48, 49, 50, 58, 59, 60, 68, 78, 79, 80, 81, 82, 83, 84, 85,
86, 87, 91, 93, 94, 97, 98, 102, 106, 107, 126, 127, 128, 129)
# definicion de funciones para rellenar el transformador base de la simulacion
calcula.moda <- function(x)
{
# x (character): columna de tipo caracter
# salida: mode de la columna
frecuencias <- table(as.character(x))
maxi <- which.max(frecuencias)
moda <- frecuencias[maxi]
return(names(moda))
}
calcula.mediana <- function(x)
{
# x (numeric): columna de tipo numerica
# salida: mediana de la columna
mediana <- median(x)
return( mediana)
}
###############################################
# correcion de tipos de Datos y construccion del transformador base para la simulacion en la app ###########
datos <- read.csv("dataframeVerdesPresentes.csv", stringsAsFactors = FALSE) #
sapply(datos, class)
categoricas
names(datos)[categoricas]
# cast de numericas a factores 'character' para que las salidas de 'predict' sean caracteres y no niveles
datos[, categoricas] <- lapply(datos[, categoricas], function(x) factor(x))
datos[, embarque] <- lapply(datos[, embarque], function(x) factor(x))
# construccion de transformacion base para la app
entrada <- datos[1, ]
entrada[1, categoricas] <- mapply(datos[, categoricas], FUN=calcula.moda)
entrada[1, embarque] <- mapply(datos[, embarque], FUN=calcula.moda)
entrada[1, numericas] <- mapply(datos[, numericas], FUN=calcula.mediana)
sapply(datos[, numericas],class)
match(c('iAltEmbarqueMax', 'iAnchoEmbarqueMax', 'iPesoEmbarqueMax'), names(datos) )
embarque
