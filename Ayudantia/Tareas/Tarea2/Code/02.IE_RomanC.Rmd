---
title: "Tarea 2 inferencia"
author: "Roman Castillo C."
output:
  pdf_document: default
  word_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, cache=TRUE)
```


### EJERCICIO 4
 
##### A.

Codigo para la  simulacion de lanzamientos:
```{r echo=T}

simgeo<-function(N,p){

##Moneda 1:aguila 0:sol
moneda<-c(1,0)

## Creacion del vector donde se guardan resultados
resultados<-rep(0,N)
## Numero de exitos para terminar la simulacion
r<-1

## Inicio de la simulacion

for(i in 1:N){
  #contador del numero de tiros
  tiros<-0
  #contador del numero de exitos
  exitos<-0
## Se tira la moneda obtener r exitos  
  while(exitos<r){
    if(sample(moneda,1,replace=T, prob = c(p,1-p))==1)
      { exitos=1}
    tiros<-tiros +1
  }
## Se guarda el numero de tiros
  resultados[i]<-tiros
}
   return(resultados)
}
```


##### B.

Se realizan $10^4$ simulaciones con $p_1=0.5$,$p_2=0.1$,$p_3=0.01$

```{r echo=TRUE}
set.seed(15)
p_0.5<-simgeo(10^4,0.5)
p_0.1<-simgeo(10^4,0.1)
p_0.01<-simgeo(10^4,0.01)
```


Ahora se realizan los graficos solicitados con la comparacion de masa correspondiente


```{r}
# Reticula para los graficos
#par(mfrow=c(3,1))


##layout(matrix(c(1,2,3), 3, 1, byrow = TRUE), 
  	##widths=c(1,1), heights=c(1,1))

#-------------------------------------p=0.5

#Grafica de las proporciones por la cantidad de aguilas observadas
plot(prop.table(table(p_0.5)),
     type="h",
     col="darkred", 
     xlab = "", 
     ylab="", 
     main = "Comparacion entre simulacion y distribucion terica" )
par(new=TRUE)
#Grafica de la distribucion teorica Geom(p=0.5)

x<-sort(unique(p_0.5))
plot((x+0), dgeom(x,0.5),
     type="p",
     axes= F,  
     col="dodgerblue4",
     xlab = "aguilas obtenidas", 
     ylab="Probabilidad" )
legend("topright", inset=.01, title="",
  	c("simulacion","Geom(p=0.5)"), fill=c("darkred","dodgerblue4"), horiz=F)

#-------------------------------------p=0.1

#Grafica de las proporciones por la cantidad de aguilas observadas
plot(prop.table(table(p_0.1)),
     type="h",
     col="darkred", 
     xlab = "", 
     ylab="", 
     main = "Comparacion entre simulacion y distribucion teorica" )
par(new=TRUE)
#Grafica de la distribucion teorica Geom(p=0.1)
y<-sort(unique(p_0.1))
plot((y), dgeom(y,0.1),
     type="p",
     axes= F,  
     col="dodgerblue4",
     xlab = "aguilas obtenidas", 
     ylab="Probabilidad" )
legend("topright", inset=.01, title="",
  	c("simulacion","Geom(p=0.1)"), fill=c("darkred","dodgerblue4"), horiz=F)



#-------------------------------------p=0.01

#Grafica de las proporciones por la cantidad de aguilas observadas
plot(prop.table(table(p_0.01)),
     type="h",
     col="darkred", 
     xlab = "", 
     ylab="", 
     main = "Comparacion entre simulacion y distribucion teorica" )
par(new=TRUE)
#Grafica de la distribucion teorica Geom(p=0.1)
z<-sort(unique(p_0.01))
plot(z, dgeom(z,0.01),
     type="p",
     axes= F,  
     col="dodgerblue4",
     xlab = "aguilas obtenidas", 
     ylab="Probabilidad" )
legend("topright", inset=.01, title="",
  	c("simulacion","Geom(p=0.01)"), fill=c("darkred","dodgerblue4"), horiz=F)


```



##### C.

Se repite el ejercicio anterior $10^6$ simulaciones 

```{r echo=TRUE}
set.seed(15)
p2_0.5<-simgeo(10^6,0.5)
p2_0.1<-simgeo(10^6,0.1)
p2_0.01<-simgeo(10^6,0.01)
```


Ahora se realizan los graficos solicitados con la comparacion de masa correspondiente


```{r}
# Retcula para los graficos
##par(mfrow=c(3,1))

#-------------------------------------p=0.5

#Grafica de las proporciones por la cantidad de aguilas observadas
plot(prop.table(table(p2_0.5)),
     type="h",
     col="darkred", 
     xlab = "", 
     ylab="", 
     main = "Comparacin entre simulacion y distribucion teorica" )
par(new=TRUE)
#Grafica de la distribucion teorica Geom(p=0.5)

x<-sort(unique(p2_0.5))
plot((x+1), dgeom(x,0.5),
     type="p",
     axes= F,  
     col="dodgerblue4",
     xlab = "aguilas obtenidas", 
     ylab="Probabilidad" )
legend("topright", inset=.01, title="",
  	c("simulacion","Geom(p=0.5)"), fill=c("darkred","dodgerblue4"), horiz=F)

#-------------------------------------p=0.1

#Grafica de las proporciones por la cantidad de aguilas observadas
plot(prop.table(table(p2_0.1)),
     type="h",
     col="darkred", 
     xlab = "", 
     ylab="", 
     main = "Comparacion entre simulacion y distribucion teorica" )
par(new=TRUE)
#Grafica de la distribucion teorica Geom(p=0.1)
y<-sort(unique(p2_0.1))
plot((y+1), dgeom(y,0.1),
     type="p",
     axes= F,  
     col="dodgerblue4",
     xlab = "aguilas obtenidas", 
     ylab="Probabilidad" )
legend("topright", inset=.01, title="",
  	c("simulacion","Geom(p=0.1)"), fill=c("darkred","dodgerblue4"), horiz=F)



#-------------------------------------p=0.01

#Grafica de las proporciones por la cantidad de aguilas observadas
plot(prop.table(table(p2_0.01)),
     type="h",
     col="darkred", 
     xlab = "", 
     ylab="", 
     main = "Comparacion entre simulacion y distribucion teorica" )
par(new=TRUE)
#Grafica de la distribucion teorica Geom(p=0.1)
z<-sort(unique(p2_0.01))
plot((z+1), dgeom(z,0.01),
     type="p",
     axes= F,  
     col="dodgerblue4",
     xlab = "aguilas obtenidas", 
     ylab="Probabilidad" )
legend("topright", inset=.01, title="",
  	c("simulacion","Geom(p=0.01)"), fill=c("darkred","dodgerblue4"), horiz=F)


```


Se solicita el calculo de la media y varianza de las simulaciones:
```{r}
cat(
  "para p=0.5 se obtuvo una media de: ",round(mean(p2_0.5),2), 
  "y una varianza de,",round(sqrt(var(p2_0.5)),2),"\n",
  "para p=0.1 se obtuvo una media de: ",round(mean(p2_0.1),2), 
  "y una varianza de,",round(sqrt(var(p2_0.1)),2),"\n",
  "para p=0.01 se obtuvo una media de: ",round(mean(p2_0.01),2), 
  "y una varianza de,",round(sqrt(var(p2_0.01)),2),"\n")

```

El valor esperado para distribucion teorica en cada eso:

* Para $Geom(0.5)$ su valor esperado es 2 y su desviacion estandar 2
* Para $Geom(0.1)$ su valor esperado es 10 y su desviacion estandar 9.48
* Para $Geom(0.01)$ su valor esperado es 100 y su desviacion estandar 99.49

Puede notarse que al aumentar las simulaciones, los valores esperados de la simulacion se aproximan a los valores teoricos.

### EJERCICIO 5
 
##### A.


Codigo para la  simulacion de lanzamientos hasta r exitos:
```{r echo=T}

simbneg<-function(N,p,r){

##Moneda 1:aguila 0:sol
moneda<-c(1,0)

## Creacion del vector donde se guardan resultados
resultados<-rep(0,N)

## Inicio de la simulacion

for(i in 1:N){
  #contador del numero de tiros
  tiros<-0
  #contador del numero de exitos
  exitos<-0
## Se tira la moneda hasta obtener r exitos  
  while(exitos<r){
    if(sample(moneda,1,replace=T, prob = c(p,1-p))==1)
      { exitos= exitos+1}
    tiros<-tiros +1
  }
## Se guarda el numero de tiros
  resultados[i]<-tiros
}
   return(resultados)
}
```



##### B.
Se realizan las 4 simulaciones solicitadas
* $N=$10^6$,$p=0.2$,$r=2$
* $N=$10^6$,$p=0.2$,$r=7$
* $N=$10^6$,$p=0.1$,$r=2$
* $N=$10^6$,$p=0.1$,$r=7$


```{r}
set.seed(15)
bn<-simbneg(10^6,0.2,2)
bn1<-simbneg(10^6,0.2,7)
bn2<-simbneg(10^6,0.1,2)
bn3<-simbneg(10^6,0.1,7)
```


Los graficos de comparacion se presentan a continuacion:

```{r echo=FALSE}

##par(mfrow=c(4,1))

#-------------------------------------p=0.2 r=2

#Grafica de las proporciones por la cantidad de aguilas observadas
plot(prop.table(table(bn)),
     type="h",
     col="darkred", 
     xlab = "", 
     ylab="", 
     main = "Comparacion entre simulacion y distribucion teorica" )
par(new=TRUE)
#Grafica de la distribucion teorica BN(p=0.2, r=2)
z1<-(sort(unique(bn))-2)
plot((z1+1), dnbinom(z1,2,0.2),
     type="p",
     axes= F,  
     col="dodgerblue4",
     xlab = "aguilas obtenidas", 
     ylab="Probabilidad" )
legend("topright", inset=.01, title="",
  	c("simulacion","BN(p=0.2, r=2)"), fill=c("darkred","dodgerblue4"), horiz=F)



#---------------------------------------p=0.2 r=7-------------------------------
#Grafica de las proporciones por la cantidad de aguilas observadas
plot(prop.table(table(bn1)),
     type="h",
     col="darkred", 
     xlab = "", 
     ylab="", 
     main = "Comparacion entre simulacion y distribucion teorica" )
par(new=TRUE)
#Grafica de la distribucion teorica BN(p=0.2, r=7)
z1<-(sort(unique(bn1))-7)
plot((z1+1), dnbinom(z1,7,0.2),
     type="p",
     axes= F,  
     col="dodgerblue4",
     xlab = "aguilas obtenidas", 
     ylab="Probabilidad" )
legend("topright", inset=.01, title="",
  	c("simulacion","BN(p=0.2, r=7)"), fill=c("darkred","dodgerblue4"), horiz=F)

#---------------------------------------p=0.1 r=2-------------------------------

#Grafica de las proporciones por la cantidad de aguilas observadas
plot(prop.table(table(bn2)),
     type="h",
     col="darkred", 
     xlab = "", 
     ylab="", 
     main = "Comparacion entre simulacion y distribucion teorica" )
par(new=TRUE)
#Grafica de la distribucion teorica BN(p=0.1, r=2)
z1<-(sort(unique(bn2))-2)
plot((z1+1), dnbinom(z1,2,0.1),
     type="p",
     axes= F,  
     col="dodgerblue4",
     xlab = "aguilas obtenidas", 
     ylab="Probabilidad" )
legend("topright", inset=.01, title="",
  	c("simulacion","BN(p=0.1, r=2)"), fill=c("darkred","dodgerblue4"), horiz=F)


#---------------------------------------p=0.1 r=7-------------------------------

#Grafica de las proporciones por la cantidad de aguilas observadas
plot(prop.table(table(bn3)),
     type="h",
     col="darkred", 
     xlab = "", 
     ylab="", 
     main = "Comparacion entre simulacion y distribucion teorica" )
par(new=TRUE)
#Grafica de la distribucion teorica BN(p=0.1, r=7)
z1<-sort(unique(bn3))
plot((z1), dnbinom(z1-7,7,0.1),
     type="p",
     axes= F,  
     col="dodgerblue4",
     xlab = "aguilas obtenidas", 
     ylab="Probabilidad" )
legend("topright", inset=.01, title="",
  	c("simulacion","BN(p=0.1, r=7)"), fill=c("darkred","dodgerblue4"), horiz=F)




```





### EJERCICIO 9


 
##### A.
Funcion para simular un proceso poisson en intervalo [0, T] y una lambda conocida

```{r echo=TRUE}

procesoPoisson<-function(lambda, t){

intervalos<-1000
dt<-t/intervalos
tiempos<-seq(0, t , by= dt)
resultados <- rep(0, intervalos+2)
for(i in 1:intervalos+1 ){

  resultados[i+1]<- resultados[i] + rbinom(1,1,lambda*dt) 
}
 return(resultados) 
}

```

Se realizan las 3 simulaciones y posteriormente se muestra la grafica correspondiente
```{r}

tiempos<-seq(0, 10 , by= 10/1000)

ppss1<-procesoPoisson(2,10)
ppss2<-procesoPoisson(2,10)
ppss3<-procesoPoisson(2,10)


plot(stepfun(tiempos,ppss1), verticals= FALSE, xlab="tiempo",ylab="ocurrencias", main = "Trayectoria lambda=2 (primera repeticion)" )
plot(stepfun(tiempos,ppss2), verticals= FALSE, xlab="tiempo",ylab="ocurrencias", main = "Trayectoria lambda=2 (segunda repeticion)" )
plot(stepfun(tiempos,ppss3), verticals= FALSE, xlab="tiempo",ylab="ocurrencias", main = "Trayectoria lambda=2 (tercera repeticion)" )


```



##### B.

Modificamos la funcion anterior para  ajustarla  a los objetivos del ejercicio:



```{r}
procesoPoisson2<-function(N,lambda,t){

intervalos<-1000
dt<-t/intervalos
tiempos<-seq(0, t , by= dt)
resultados <- rep(0, intervalos+2)
for(i in 1:N){
acum<-0
for(i in 1:intervalos +1){

  acum= acum + rbinom(1,1,(lambda*dt +10^-6)) 
}
 resultados[i+1]=acum
 
}
return(resultados)
}
```


Ahora realizamos las simulacion (10^4 simulaciones, tiempo (0,1), $\lambda=0.5$)
```{r echo=TRUE}
simpropois <- procesoPoisson2(10^4,0.5,1)
```

Realizamos la comparativa con la distribucion Poisson($\lambda=0.5$):




```{r}

#Grafica de las proporciones por la cantidad de aguilas observadas
plot(prop.table(table(simpropois)),
     type="h",
     col="darkred", 
     xlab = "", 
     ylab="", 
     main = "Comparacion entre simulacion y distribucion teorica" )
par(new=TRUE)
#Grafica de la distribucion teorica Geom(p=0.1)
z<-sort(unique(simpropois))
plot((z), dpois(z,0.5),
     type="p",
     axes= F,  
     col="dodgerblue4",
     xlab = "exitos", 
     ylab="Probabilidad" )
legend("topright", inset=.01, title="",
  	c("simulacion","Poisson(lambda=1/2)"), fill=c("darkred","dodgerblue4"), horiz=F)



```

